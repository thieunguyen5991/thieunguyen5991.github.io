<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.73.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Thieu Nguyen">
<meta name="keywords" content="">
<meta name="description" content="Every server that i run in my homelab is more then often a virtual machine, and heres the run down!">


<meta property="og:description" content="Every server that i run in my homelab is more then often a virtual machine, and heres the run down!">
<meta property="og:type" content="article">
<meta property="og:title" content="What Virtual Machines Am I Running?">
<meta name="twitter:title" content="What Virtual Machines Am I Running?">
<meta property="og:url" content="https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
<meta property="twitter:url" content="https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
<meta property="og:site_name" content="Thieu Nguyen&#39;s Blog">
<meta property="og:description" content="Every server that i run in my homelab is more then often a virtual machine, and heres the run down!">
<meta name="twitter:description" content="Every server that i run in my homelab is more then often a virtual machine, and heres the run down!">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-05-17T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-05-17T00:00:00">
  
  
  
    
      <meta property="article:section" content="Homelab">
    
      <meta property="article:section" content="Elastic-co">
    
      <meta property="article:section" content="VirtualMachines">
    
  
  
    
      <meta property="article:tag" content="homelab">
    
      <meta property="article:tag" content="security">
    
      <meta property="article:tag" content="elasticsearch">
    
      <meta property="article:tag" content="elk">
    
      <meta property="article:tag" content="kibana">
    
      <meta property="article:tag" content="logstash">
    
      <meta property="article:tag" content="elastic-co">
    
      <meta property="article:tag" content="radarr">
    
      <meta property="article:tag" content="sonarr">
    
      <meta property="article:tag" content="vmware">
    
      <meta property="article:tag" content="esxi">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@thieunguyen5991">


  <meta name="twitter:creator" content="@thieunguyen5991">






  <meta property="og:image" content="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/header.png">
  <meta property="twitter:image" content="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/header.png">


  <meta property="og:image" content="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/header.png">
  <meta property="twitter:image" content="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/header.png">




  <meta property="og:image" content="https://www.gravatar.com/avatar/435730f573f686aa570b7607ed361ded?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/435730f573f686aa570b7607ed361ded?s=640">


    <title>What Virtual Machines Am I Running?</title>

    <link rel="icon" href="https://thieunguyen5991.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://thieunguyen5991.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-115328400-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://thieunguyen5991.github.io/">Thieu Nguyen&#39;s Blog</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://thieunguyen5991.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/435730f573f686aa570b7607ed361ded?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://thieunguyen5991.github.io/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/435730f573f686aa570b7607ed361ded?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Thieu Nguyen</h4>
        
          <h5 class="sidebar-profile-bio">Knowledge is power, but sharing it is the way to achieve immortality.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/page/about-me">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About Me</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/thieunguyen5991" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/thieunguyen5991" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://scholar.google.com/citations?user=nsTbdhgAAAAJ&amp;hl=en" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-graduation-cap"></i>
      
      <span class="sidebar-button-desc">GG Scholar</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.researchgate.net/profile/Thieu_Nguyen6" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-flag-checkered"></i>
      
      <span class="sidebar-button-desc">ResearchGate</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://thieunguyen5991.github.io/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              post-header-cover--partial"
       style="background-image:url('/img/posts/2020/05/what-virtual-machines-am-i-running/header.png')"
       data-behavior="5">
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaOut
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      What Virtual Machines Am I Running?
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-05-17T00:00:00Z">
        
  May 17, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://thieunguyen5991.github.io/categories/homelab">Homelab</a>, 
    
      <a class="category-link" href="https://thieunguyen5991.github.io/categories/elastic-co">Elastic-co</a>, 
    
      <a class="category-link" href="https://thieunguyen5991.github.io/categories/virtualmachines">VirtualMachines</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <div class="alert info ">
  <p><strong>Disclaimer, this is subject to change&hellip; very often and very quickly!</strong></p>
</div>
</div>
<div class="figure figure--fullWidth">
  <img class="figure-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/home_network-securitybits.png" alt="The &#39;current&#39; network architecture" /><span class="caption">The &#39;current&#39; network architecture</span>
</div>
<div class="main-content-wrap">
<p>To start off everything that you can see is running under ESXi-6.7 on my VRTX, which is managed by vCenter-6.7. Though this will soon be upgraded to 7.0 as soon as VMware releases 7.0u1.</p>
<h2 id="hypervisor">Hypervisor</h2>
<h3 id="dell-vrtx-aegir">Dell VRTX (Aegir)</h3>
<p>This is my main hypervisor server, basically a homelab in a box! the nifty thing about the VRTX is that you do have the storage as well as 4 blades in one 5u package! This makes it really convenient, although you kinda miss out on all the good homelab life, in regards to multiple rack servers and networking.</p>
<h4 id="blades">Blades</h4>
<p>Theres two sets of blades with identical hardware:<br>
<strong>Eldir-01 / 02</strong><br>
Dell M520<br>
Xeon E5-2420v2<br>
64GB DDR3 ECC-Dual<br>
2x Seagate 146GB 15k SAS<br>
<strong>Eldir-03 / 04</strong><br>
Dell M520<br>
2x Xeon E5-2407<br>
44GB DDR3 ECC Dual Rank</p>
<h4 id="vm-storage">VM Storage</h4>
<p>The VRTX comes with 25 2,5&rdquo; SAS Disk shelf! which makes it possible to have up 48TB of storage shared between the 4 blades!<br>
Currently I have 9 drives, with 8 of them spanned in a Raid50 for 3,3TB and one in hot spare (in case one drive would break it would automatically re-silver).</p>
<h2 id="fileserver">Fileserver</h2>
<h3 id="dell-r510">Dell R510</h3>
<p>Now this server started off as a 10gig file server that where used to store shared VMs, back when i ran multiple 2u rack servers.<br>
But the specs are quite simple<br>
Single Xeon E5620<br>
32GB DDR3 ECC Ram<br>
12x 4tb Seagate Constellation Es.3 (Main storage)<br>
2x 240GB WD Green SATA SSD (SLOG)</p>
<h2 id="virtual-machines">Virtual Machines</h2>
<p>Now that we got that out of the way, lets dive into the meat of this post.
I&rsquo;ve split my VMs into a few different subnets to keep them organized!</p>
<h2 id="vmware">VMWare</h2>
<h3 id="vcenter">vCenter</h3>


 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/vcenter_screenshot.png" title="vCenter Dashboard" data-fancybox-group="">
  
    <img class="fig-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/vcenter_screenshot.png"  alt="vCenter Dashboard">
  
    </a>
  
   
    <span class="caption">vCenter Dashboard</span>
  
</div>

<p>4 vCPU/16GB RAM/~200GB Disk<br>
My vCenter is the main control hub for my homelab and its VMs, where all the provisioning happens, as well as the internal vmware network. It&rsquo;s chomping RAM like nobody&rsquo;s business, but it is necessary as i do not want to switch to Proxmox or Xen server.</p>
<h2 id="private">Private</h2>
<p>My Private stack is where I put the VMs that I do not want to have direct internet access and mainly where I put internal services.</p>
<h3 id="saltstack">SaltStack</h3>


 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/SaltStack-logo.png" title="SaltSTack Logo" data-fancybox-group="">
  
    <img class="fig-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/SaltStack-logo.png"  alt="SaltSTack Logo">
  
    </a>
  
   
    <span class="caption">SaltSTack Logo</span>
  
</div>

<p>2 vCPU/2GB Ram/100GB Disk<br>
Many people have probably heard of puppet, chef and ansible&hellip; but maybe not <a href="https://saltstack.com">SaltStack</a>. It works by a master-minion system, this is the master, and on each linux VM there is a minion process running. You can also use salt-ssh, which makes it login and run commands, which works, but you loose some of the functions such as the reactor-bus etc. which define actions/states that the minion will perform on changes. Now there&rsquo;s a rather big debate on what orchestration tool that you should use. Granted there is a lot that&rsquo;s already made for ansible, and it is popular and more heard of as well. The reason that i fell down into SaltStack is that i found it had all the features that i wanted from ansible, and then some. Suffice it to say that all the following virtual machines are provisioned to my vCenter using Salt-Cloud.</p>
<h3 id="siem--network-logging-solution">SIEM / Network logging solution</h3>


 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/Elastic-Stack.png" title="Elastic-Stack Architecture" data-fancybox-group="">
  
    <img class="fig-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/Elastic-Stack.png"  alt="Elastic-Stack Architecture">
  
    </a>
  
   
    <span class="caption">Elastic-Stack Architecture</span>
  
</div>

<p>Now this setup might warrant some comments about &ldquo;overkill&rdquo; (and probably its own post), but safe to say is that i am a huge elastic-stack fan. My cluster is a Hot-Warm architecture, with the addition of, if i ever need to, also do cold storage. Each of the nodes are properly secured, which isn&rsquo;t the easiest task. All the log transfer, rotation etc. are being done by either syslog, or beats. I do run the whole suite of beats:</p>
<ul>
<li>Filebeat, for every relevant file based log.</li>
<li>Auditbeat, security events such as file changes, user logins or processes.</li>
<li>Packetbeat, packets and netflow.</li>
<li>Metricbeat, I used to run a influxdb and grafana, but recently switched to metricbeat for convenience.</li>
</ul>
<h4 id="siem-elasticsearch-master">SIEM Elasticsearch Master</h4>
<p>2 vCPU/4GB Ram/32GB Disk<br>
The Elastic-stack Master nodes are the glue that holds the cluster together, and if you didn&rsquo;t know&hellip; they LOVE ram! Now why 3 you might ask? Split-brain syndrome! 3 is the recommended minimum number in order to not have a split-brain syndrome, which happens when you have an even number of masters and what might happen is a 2 sided argument where both sides are even. In order to tip the scale Elastic recommends that you have an uneven number of nodes. Luckily the master nodes are usually not the largest VMs that you have so it doesn&rsquo;t hurt to have 3 or 5 depending on the use case. Also note that these are <strong>only</strong> responsible for the Mastering of the other nodes, so they are not responsible for ingesting data, storing data or manipulating data.</p>
<h4 id="siem-elasticsearch-hot">SIEM Elasticsearch Hot</h4>
<p>4 vCPU/6GB Ram/250GB Disk<br>
The &ldquo;Hot&rdquo; nodes have two main functions, ingesting logs, and storing a couple days of logs, on several shards on the hot nodes. These usually reside on SSD storage and are the main nodes in the cluster that handles searching the most relevant data. Depending on your lograte you might want to have it on SSDs and on 10gig network. In my environment i have ~300events / second, and a daily index is around 10-25GB, and a daily index is held on a hot node for 14 days before its rotated to a warm node.</p>
<h4 id="siem-elasticsearch-warm">SIEM Elasticsearch Warm</h4>
<p>4 vCPU/6GB Ram/250GB Disk<br>
A warm node is only responsible for searching data, and storing data long term. These nodes are usually on a regular spinning disk as that kind of storage are cheaper, and a user does not generally hit the warm indexes as often as the hot ones. For my setup, depending on the index i keep for example my Filebeat (syslog) for 90days, which may seem long, but mangling data is kind of fun!</p>
<h4 id="siem-logstash">SIEM Logstash</h4>
<p>2 vCPU/2GB Ram/32GB Disk<br>
Now other Elastic-Stack purists might yell at me for running beats through logstash. But i have some reasons, mainly i like to have one interface for ingesting logs! I do run SNMP fetching, syslog mangling, ingesting iDRAC logs etc. to my logstash, which would just makes the firewall rules easier to manage as it only exposes the logstash ports externally from the cluster! Doing it this way also load balances the lograte rather nicely.</p>
<h4 id="siem-kibana">SIEM Kibana</h4>
<p>4 vCPU/4GB Ram/32GB Disk<br>
Every logging solution, wether it be influx, nagios etc. need a front end. Elastic-Stacks solution is Kibana, this also contains apps such as Development tools for API-calls, SIEM detection, Health metric visualization etc.</p>


 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/kibana_dashboard.png" title="Kibana Metricbeat Dashboard" data-fancybox-group="">
  
    <img class="fig-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/kibana_dashboard.png"  alt="Kibana Metricbeat Dashboard">
  
    </a>
  
   
    <span class="caption">Kibana Metricbeat Dashboard</span>
  
</div>

<h3 id="php-ipam">PHP Ipam</h3>
<p>1 vCPU/1GB Ram/32GB Disk<br>
Since I like organization, this was one of the best VMs that i could create. As this allows me to have my IP address space organized also makes it easy to look up where i have free addresses for new projects.</p>
<h3 id="gitlab-runner">Gitlab runner</h3>
<p>2 vCPU/2GB Ram/250GB Disk<br>
This is actually the only docker host that i have, and is a companion to my gitlab server. This is responsible to run the pipelines in docker containers that are defined in gitlab. wether it can be to build malware stubs or compile malicious binaries (Yeah I&rsquo;m a pentester, what did you expect).</p>
<h3 id="plex-server">Plex server</h3>
<p>4 vCPU/4GB Ram/100GB Disk<br>
This is my only plex server for movies and tv-series. Since i travel 2-3 days sometimes, making hotel rooms boring! so this is accessible for me using my plex account. All the media is stored on Yggdrasil(NAS) and accessed over SMB.</p>
<h3 id="transmission">Transmission</h3>
<p>A torrent client with a WebUI, which is running over a VPN&hellip;. for Linux ISOs&hellip;</p>
<h3 id="tautulli">Tautulli</h3>
<p>This one provides me some monitoring and statistics on movies and series on the Plex media server. This is not being used so much, but graphs are fun!</p>
<h3 id="radarr">Radarr</h3>
<p>A VM which will organize and keep track of all your Movies, and also hooks into the download client so that it gets the highest quality.</p>
<h3 id="sonarr">Sonarr</h3>
<p>It&rsquo;s a similar too as Radarr, but for TV Shows, keeping track of your episodes and series automatically.</p>
<h3 id="bazarr">Bazarr</h3>
<p>Bazarr hooks up to your Radarr and Sonarr, and will download the correct subtitles for your specific languages and media!</p>
<h3 id="jackett">Jackett</h3>
<p>Jackett hooks into the Radarr and Sonarr VMs and just adds different trackers, and more options for finding the correct media.</p>
<h2 id="public--dmz">Public / DMZ</h2>
<p>This segment is where i put all my public facing applications, with rather strict firewall rule set which is based on host to host traffic.</p>
<h3 id="ombi">Ombi</h3>
<p>This is a self hosted application where users can create requests for plex.</p>
<h3 id="apache-webcalendar">Apache WebCalendar</h3>
<p>I am a member of a local rock climbing community, and have been for the last couple years hosted a small php web application for smartphones, which displays the club activities the coming 2 weeks in a nice format.</p>
<h3 id="gitlab">Gitlab</h3>


 
  
  
  
  
    
  
    
      
    
  

<div class="figure center" >
  
    <a class="fancybox" href="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/GitLab-Logo.jpg" title="GitLab Logo" data-fancybox-group="">
  
    <img class="fig-img" src="https://thieunguyen5991.github.io/img/posts/2020/05/what-virtual-machines-am-i-running/GitLab-Logo.jpg"  alt="GitLab Logo">
  
    </a>
  
   
    <span class="caption">GitLab Logo</span>
  
</div>

<p>2 vCPU/4GB Ram/250GB Disk<br>
Everyone needs somewhere to store their source code, this gitlab instance is responsible to house my own projects which i do not want to have on any other SaaS solution (Github). I do a lot of security research, writing malware etc. for professional use. Working as a pentester and Security Researcher I hate going out and compromising a client (on purpose and with authorization), and my malware is detected by signatures or even before execution time. Before I started hosting my own gitlab, I did a test with creating a unseen custom backdoor, tested on a fully updated windows 10, upload it to a private repo, wait for a week and retest it on a <strong>fresh</strong> windows 10 instance&hellip; detected, while yes it was not a &lsquo;state of the art&rsquo; malware, but it was enough for me to question where i should store my research. Remember, the cloud is just someone else computer. I also store all the states and maps for SaltStack on my Gitlab, which makes it accessible even if my internet dies.</p>
<h3 id="nginx-reverse-proxy">Nginx Reverse Proxy</h3>
<p>A simple reverse proxy for my different web services, nothing that&rsquo;s out of the ordinary. This VM also handles Lets Encrypt TLS Certificates.</p>
<h2 id="malware">Malware</h2>
<p>Now for the fun stuff, my malware net is the most restrictive net that i have, basically only accessible from a VPN and only have a outbound monitored internet connection. This is also the Segment that have the VMs in highest rotation, for good reason. Its purpose is basically a safe place to detonate malware and reverse live samples.</p>
<h3 id="gooseflare">GooseFlare</h3>
<p>4 vCPU/8GB Ram/80GB Disk<br>
There&rsquo;s always 1-3 instances of FireEYEs Flare VM available in this net for malware research. If you haven&rsquo;t heard of <a href="https://github.com/fireeye/flare-vm">FlareVM</a> it&rsquo;s a simple setup script for a windows VMs that contains most of all tools you&rsquo;ll need in order to reverse engineer a malware. The script is actively maintained by pull requests and FireEYE, highly recommended if you are interested in reverse engineering.</p>
<h2 id="goosedev">GooseDev</h2>
<p>Much like the Malware segment, I have a segment for developing malware. I will put up another blog post specifically on this network and its hosts but the general idea is to have a network with hosts that have different AVs installed  and block by GPO and in the network firewall malware submissions to the mother ship.</p>
<h3 id="goosedev-1">GooseDev</h3>
<p>4 vCPU/8GB Ram/150GB Disk<br>
A simple windows 10 Pro host, with Python and visual studio installed. Since a lot of malwares and C2 framework have moved on from Powershell into a more unmonitored .NET and Powershell-Less execution, there was a need to have a development machine which was easily restored to an original state when a project was completed, so that there was no lingering artifacts. During Red-Team engagements this is also a Lab which goes through heavy modifications whenever we learn something new from the client, in order to mimic our target environment as good as can be to come out successful in the end. My current project is .NET DLL injections into memory for which I&rsquo;m doing a small write up, stay tuned!</p>
<h3 id="goosetarget">GooseTarget</h3>
<p>2 vCPU/4GB Ram/60GB Disk<br>
A standard windows 7/8/10 VM which is usually as default as can be, with the only modification is that i turn off sample submissions in the Group Policy so that i don&rsquo;t burn my applications pre-engagement.</p>
<h2 id="gooselab">GooseLab</h2>
<p>Much like GooseDev subnet there&rsquo;s GooseLab, which is more of a static environment and a small domain playground to test new attacks and applications in a more controlled domain. Whats currently missing is actually a logging solution, which will probably be another Elastic-Stack and Winlogbeat.</p>
<h3 id="goosesql">GooseSQL</h3>
<p>2 vCPU/4GB Ram/40GB Disk<br>
Simple SQL Server with one database defined at the moment. Used for Authentication and some basic data storage for GooseWeb.</p>
<h3 id="gooseweb">GooseWEB</h3>
<p>2 vCPU/4GB Ram/40GB Disk<br>
IIS Server that runs a small inventory management application connected to the SQL Database for authentication and data storage.</p>
<h3 id="goosedc">GooseDC</h3>
<p>2 vCPU/4GB Ram/40GB Disk<br>
Domain controller for the domain &ldquo;Goose.Lab&rdquo; 20 users with different degrees of access. There&rsquo;s also some small special case configurations in GPO, Groups and auth schemes which makes for an interesting Saturday evening of hacking.</p>
<h2 id="finishing-up">Finishing up</h2>
<p>Now people might ask &ldquo;But what about docker or kubernetes?&rdquo;, And yes valid questions, but right now I don&rsquo;t really have the time to dig into a completely new architecture! Although i do run a couple of Docker containers for CTFs and for some tooling at work but i haven&rsquo;t not taken the step to host things of it. Also right now i have vCenter which gives me a rather solid single pane of glass on my environment, i do not feel like i would enjoy having multiple management console.<br>
One might also ask where this blog is hosted? Actually it is on Github-Pages together with a small actions script which runs every time i make a push to the blog branch. If you want you can clone and repurpose the repo for your own blog, you can find the repo here: <a href="https://github.com/Securitybits-io/blog.securitybits.io">Securitybits Github</a><br>
If you have read this far, Good job! and thank you, if you have any questions don&rsquo;t hesitate to contact me!</p>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://thieunguyen5991.github.io/2020/06/password-audits/" data-tooltip="Password audits">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://thieunguyen5991.github.io/2019/12/beats-7.5.0-on-pfsense-2.4.4/" data-tooltip="Beats 7.5.0 on PFsense 2.4.4">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Thieu Nguyen. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://thieunguyen5991.github.io/2020/06/password-audits/" data-tooltip="Password audits">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://thieunguyen5991.github.io/2019/12/beats-7.5.0-on-pfsense-2.4.4/" data-tooltip="Beats 7.5.0 on PFsense 2.4.4">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://thieunguyen5991.github.io/2020/05/what-virtual-machines-am-i-running/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fthieunguyen5991.github.io%2F2020%2F05%2Fwhat-virtual-machines-am-i-running%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fthieunguyen5991.github.io%2F2020%2F05%2Fwhat-virtual-machines-am-i-running%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fthieunguyen5991.github.io%2F2020%2F05%2Fwhat-virtual-machines-am-i-running%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/435730f573f686aa570b7607ed361ded?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Thieu Nguyen</h4>
    
      <div id="about-card-bio">Knowledge is power, but sharing it is the way to achieve immortality.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Researcher, Programmer, Gamer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Germany
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://thieunguyen5991.github.io/img/side-banner.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://thieunguyen5991.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  




    
  </body>
</html>

